[
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Timesheet", 
  "modified": "2016-09-09 19:58:12.931366", 
  "name": "Timesheet-Client", 
  "script": "frappe.ui.form.on(\"Timesheet\",\"refresh\",function(frm) {\n\tif(cur_frm.doc.signature_json){\n\t\tvar sign = \"\"\n\t\tsign = JSON.parse(\"[\" + cur_frm.doc.signature_json + \"]\")\n\t\tconsole.log(sign[0])\n                $('[data-fieldname=\"signature\"]').show() \n\t\t$('[data-fieldname=\"signature\"]').signature()\n                $('[data-fieldname=\"signature\"]').signature({disabled: true});  \n\t\t$('[data-fieldname=\"signature\"]').signature(\"draw\", sign[0])\n                $('[data-fieldname=\"signature_svg\"]').css(\"width\", \"5cm\")\n        }\n        else {\n          $('[data-fieldname=\"signature\"]').hide()\n        }  \n})", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Customer", 
  "modified": "2016-11-08 12:35:17.763947", 
  "name": "Customer-Client", 
  "script": "frappe.ui.form.on(\"Customer\", \"refresh\", function(frm) {\n\tif(!cur_frm.doc.__islocal && (cur_frm.doc.call_comming_from != \"\" && frappe.route_options)) {\n\t\t// Make Log button\n\t\tcur_frm.add_custom_button(__('Anrufe eintragen'), \n\t\tfunction() {\n\t\t\tconsole.log(\"hihihi\")\n\t\t\tclick_on_make_log_customer()                      \n\t\t}, \"icon-exclamation\", \"btn-default make_log\");\n        \n        }\n\tif(!cur_frm.doc.__islocal && !frappe.route_options) {\n\t\t// Show Log Button\n\tcur_frm.add_custom_button(__('Anrufe anzeigen'), \n\t\tfunction() {\n\t\t\tconsole.log(\"hihihi\")\n\t\t\tshow_logs_customer()                      \n\t\t}, \"icon-exclamation\", \"show_log\");\t\n\t}\n})\n\nshow_logs_customer = function(){\n\tif(frappe.route_options){\n\t\tconsole.log(\"in if cond\")\n\t\t//frappe.route_options[\"client_info\"] = cur_frm.doc.doctype+\"//\"+cur_frm.doc.name\n\t}\n\telse{\n\t\tconsole.log(\"in else cond\")\n\t\tfrappe.route_options = {\n\t\t\t\"client_info\":cur_frm.doc.doctype+\"//\"+cur_frm.doc.name\n\t\t}\n\t}\n\tfrappe.set_route(\"query-report\", \"Call Logs Report\");\n}\n\n\nclick_on_make_log_customer = function(name){\n    if (frappe.route_options){\n\t\tconsole.log(\"in frappe.route_options\",frappe.route_options)\n        var contact_person = frappe.route_options[\"contact_person\"]\n        var phone_number = frappe.route_options[\"mobile_no\"]\n        var call_receive_time = frappe.route_options[\"call_receive_time\"]\n\t\tvar contact_type = frappe.route_options[\"contact_type\"]\n        frappe.route_options = null;\n\t\ttn = frappe.model.make_new_doc_and_get_name('Call Logs');\n\t\tlocals['Call Logs'][tn].contact_person = contact_person\n\t\tlocals['Call Logs'][tn].phone_number = phone_number\n        locals['Call Logs'][tn].client = cur_frm.doc.name \n\t\tlocals['Call Logs'][tn].start_time = call_receive_time.split(\" \")[1]\n\t\tlocals['Call Logs'][tn].call_attendant = user\n        locals['Call Logs'][tn].contact_type = contact_type\n\t\tfrappe.set_route('Form', 'Call Logs', tn);\n    }\n    else{ \n\t\ttn = frappe.model.make_new_doc_and_get_name('Call Logs');\n\t\tlocals['Call Logs'][tn].contact_person = cur_frm.doc.call_comming_from.split(\"/\")[1]\n\t\tlocals['Call Logs'][tn].phone_number = cur_frm.doc.call_comming_from.split(\"/\")[0]\n        locals['Call Logs'][tn].client = cur_frm.doc.name\n\t\tlocals['Call Logs'][tn].start_time = frappe.datetime.now_datetime().split(\" \")[1]\n\t\tlocals['Call Logs'][tn].call_attendant = user\n        locals['Call Logs'][tn].contact_type = cur_frm.doc.doctype\n\t\tfrappe.set_route('Form', 'Call Logs', tn);\n\t}     \n}", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Contact", 
  "modified": "2016-11-07 11:43:40.086050", 
  "name": "Contact-Client", 
  "script": "frappe.ui.form.on('Contact',{ \n\trefresh: function(frm) {\n\t\tif(!cur_frm.doc.__islocal && frappe.route_options){\n\t\t\tif(frappe.route_options[\"doctype\"] && frappe.route_options[\"doc_name\"] && frappe.route_options[\"new_contact\"] == \"Yes\"){\n\t\t        frappe.route_options[\"contact_person\"] = cur_frm.doc.name\n\t\t\t\tfrappe.route_options[\"mobile_no\"] = cur_frm.doc.mobile_no      \n\t\t\t\tfrappe.set_route('Form', frappe.route_options[\"doctype\"], frappe.route_options[\"doc_name\"]); \n\t\t        //frappe.route_options = null;    \n\t\t\t}\n\t\t    if(frappe.route_options[\"mobile_no\"]){\n\t\t   \t\tcur_frm.set_value(\"mobile_no\",frappe.route_options[\"mobile_no\"]) \n\t\t    }\n\t    }\n\t    if(!cur_frm.doc.__islocal && !cur_frm.doc.__unsaved){\n\t\t\t// show log button\n\t\t\tcur_frm.add_custom_button(__('Anrufe anzeigen'),\n\t\t\tfunction() {\n\t\t\t\tconsole.log(\"hihihi\")\n\t\t\t\tshow_logs_contact();                      \n\t\t\t}, \"icon-exclamation\", \"btn-default show_logs\");\t\t\n\t\t}\n\t},\n\tvalidate: function(frm) {\n\t\tif(!cur_frm.doc.__islocal && frappe.route_options){\n\t\t\tfrappe.route_options[\"new_contact\"] = \"Yes\"\n\t\t}\n\t}\n})\n\nshow_logs_contact = function(){\n    if(frappe.route_options){\n\t\tconsole.log(\"in if cond\")\n\t\tfrappe.route_options[\"client_info\"] = cur_frm.doc.doctype+\"//\"+cur_frm.doc.name+\"//\"+cur_frm.doc.mobile_no\n\t}\n\telse{\n\t\tconsole.log(\"in else cond contact 123\")\n\t\tfrappe.route_options = {\n\t\t\t\"client_info\":cur_frm.doc.doctype+\"//\"+cur_frm.doc.name+\"//\"+cur_frm.doc.mobile_no\n\t\t}\n\t} \n\tfrappe.set_route(\"query-report\", \"Call Logs Report\");\n}", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Supplier", 
  "modified": "2016-11-09 14:43:48.755024", 
  "name": "Supplier-Client", 
  "script": "frappe.ui.form.on(\"Supplier\", \"refresh\", function(frm) {\n\tif(!cur_frm.doc.__islocal && cur_frm.doc.call_comming_from != \"\" || frappe.route_options) {\n\t\t// Make Log button \n\t\tcur_frm.add_custom_button(__('Anrufe eintragen'),\n\t\tfunction() {\n\t\t\tconsole.log(\"hihihi\")\n\t\t\tclick_on_make_log_supplier()                      \n\t\t}, \"icon-exclamation\", \"btn-default make_log\");\n\t}\n\tif(!cur_frm.doc.__islocal && !frappe.route_options) {\n\t// show log\n\tcur_frm.add_custom_button(__('Anrufe anzeigen'), \n\t\tfunction() {\n\t\t\tconsole.log(\"hihihi\")\n\t\t\tshow_logs_supplier()                      \n\t\t}, \"icon-exclamation\", \"show_log\");\t\n\t}\n})\n\nshow_logs_supplier = function(){\n\tif(frappe.route_options){\n\t\tconsole.log(\"in if cond\")\n\t\tfrappe.route_options[\"client_info\"] = cur_frm.doc.doctype+\"//\"+cur_frm.doc.name\n\t}\n\telse{\n\t\tconsole.log(\"in else cond\")\n\t\tfrappe.route_options = {\n\t\t\t\"client_info\":cur_frm.doc.doctype+\"//\"+cur_frm.doc.name\n\t\t}\n\t} \n\tfrappe.set_route(\"query-report\", \"Call Logs Report\");\n}\n\nclick_on_make_log_supplier = function(name){\n    if (frappe.route_options){\n\t\tconsole.log(\"in frappe.route_options\",frappe.route_options)\n        var contact_person = frappe.route_options[\"contact_person\"]\n        var phone_number = frappe.route_options[\"mobile_no\"]\n\t\tvar call_receive_time = frappe.route_options[\"call_receive_time\"]\n\t\tvar contact_type = frappe.route_options[\"contact_type\"]\n        frappe.route_options = null;\n\t\ttn = frappe.model.make_new_doc_and_get_name('Call Logs');\n\t\tlocals['Call Logs'][tn].contact_person = contact_person\n\t\tlocals['Call Logs'][tn].phone_number = phone_number\n        locals['Call Logs'][tn].client = cur_frm.doc.name\n\t\tlocals['Call Logs'][tn].start_time = call_receive_time.split(\" \")[1]\n        locals['Call Logs'][tn].call_attendant = user\n\t\tlocals['Call Logs'][tn].contact_type = contact_type\n\t\tfrappe.set_route('Form', 'Call Logs', tn);\n    }\n   \telse{\n\t \ttn = frappe.model.make_new_doc_and_get_name('Call Logs');\n\t\tlocals['Call Logs'][tn].phone_number = cur_frm.doc.call_comming_from.split(\"/\")[0]\n\t\tlocals['Call Logs'][tn].contact_person = cur_frm.doc.call_comming_from.split(\"/\")[1]\n        locals['Call Logs'][tn].client = cur_frm.doc.name \n\t\tlocals['Call Logs'][tn].start_time = frappe.datetime.now_datetime().split(\" \")[1]\n\t\tlocals['Call Logs'][tn].call_attendant = user\n        locals['Call Logs'][tn].contact_type = cur_frm.doc.doctype\n\t\tfrappe.set_route('Form', 'Call Logs', tn);\n\t}\n}", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Sales Partner", 
  "modified": "2016-11-09 14:43:38.460735", 
  "name": "Sales Partner-Client", 
  "script": "frappe.ui.form.on(\"Sales Partner\", \"refresh\", function(frm) {\n\tif(!cur_frm.doc.__islocal && (cur_frm.doc.call_comming_from != \"\" || frappe.route_options)) {\n\t\t// Make Log button\n\t\tcur_frm.add_custom_button(__('Anrufe eintragen'), \n\t\tfunction() {\n\t\t\tconsole.log(\"hihihi\")\n\t\t\tclick_on_make_log_sales_partner()                      \n\t\t}, \"icon-exclamation\", \"btn-default make_log\");\t\n\t}\n\tif(!cur_frm.doc.__islocal && !frappe.route_options) {\n\t// show log button\n\tcur_frm.add_custom_button(__('Anrufe anzeigen'), \n\t\tfunction() {\n\t\t\tconsole.log(\"hihihi\")\n\t\t\tshow_logs_sales_partner()                      \n\t\t}, \"icon-exclamation\", \"show_log\");\t\n\t}\n})\n\n\nshow_logs_sales_partner = function(){\n\tif(frappe.route_options){\n\t\tconsole.log(\"in if cond\")\n\t\tfrappe.route_options[\"client_info\"] = cur_frm.doc.doctype+\"//\"+cur_frm.doc.name\n\t}\n\telse{\n\t\tconsole.log(\"in else cond\")\n\t\tfrappe.route_options = {\n\t\t\t\"client_info\":cur_frm.doc.doctype+\"//\"+cur_frm.doc.name\n\t\t}\n\t} \n\tfrappe.set_route(\"query-report\", \"Call Logs Report\");\n}\n\nclick_on_make_log_sales_partner = function(name){\n\tif (frappe.route_options){\n\t\tconsole.log(\"in frappe.route_options\",frappe.route_options)\n\t\tvar contact_person = frappe.route_options[\"contact_person\"]\n\t\tvar phone_number = frappe.route_options[\"mobile_no\"]\n\t\tvar call_receive_time = frappe.route_options[\"call_receive_time\"] \n\t\tvar contact_type = frappe.route_options[\"contact_type\"]\n\t\tfrappe.route_options = null;\n\t\ttn = frappe.model.make_new_doc_and_get_name('Call Logs');\n\t\tlocals['Call Logs'][tn].contact_person = contact_person\n\t\tlocals['Call Logs'][tn].phone_number = phone_number\n\t\tlocals['Call Logs'][tn].client = cur_frm.doc.name\n\t\tlocals['Call Logs'][tn].start_time = call_receive_time.split(\" \")[1]\n\t\tlocals['Call Logs'][tn].call_attendant = user\n\t\tlocals['Call Logs'][tn].contact_type = contact_type\n\t\tfrappe.set_route('Form', 'Call Logs', tn);\n    }\n\n    else{\n\t\ttn = frappe.model.make_new_doc_and_get_name('Call Logs');\n\t\tlocals['Call Logs'][tn].contact_person = cur_frm.doc.call_comming_from.split(\"/\")[1]\n\t\tlocals['Call Logs'][tn].phone_number = cur_frm.doc.call_comming_from.split(\"/\")[0]\n       \tlocals['Call Logs'][tn].client = cur_frm.doc.name \n\t\tlocals['Call Logs'][tn].start_time = frappe.datetime.now_datetime().split(\" \")[1]\n\t\tlocals['Call Logs'][tn].call_attendant = user\n        locals['Call Logs'][tn].contact_type = cur_frm.doc.doctype\n\t\tfrappe.set_route('Form', 'Call Logs', tn);\n    }\n}", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Call Logs", 
  "modified": "2016-11-09 16:05:44.270922", 
  "name": "Call Logs-Client", 
  "script": "frappe.ui.form.on(\"Call Logs\",{ \n\tvalidate:function(frm) {\n\t\tif(cur_frm.doc.__islocal && cur_frm.doc.start_time){\n\t\t\tcur_frm.set_value(\"end_time\",frappe.datetime.now_datetime().split(\" \")[1])\n\t\t\tfrappe.call({\n\t\t\t\tmethod: \"switsol.switsol.make_user.update_reference_person_after_making_call_logs\",\n\t\t\t\targs: {\n\t\t\t\t\t\"reference_person\": cur_frm.doc.client,\n\t\t\t\t\t\"reference_type\":cur_frm.doc.contact_type\n\t\t\t\t},\n\t\t\t\tcallback: function(r) {\n\t\t\t\t\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t},\t\n\trefresh:function(frm) {\n\t\tif(cur_frm.doc.client && !cur_frm.doc.__islocal){\n\t\t\t// Show Logs\t\n\t\t\tcur_frm.add_custom_button(__('Anrufe Anzeigen'), \n\t\t\tfunction() {\n\t\t\t\tconsole.log(\"hihihi\")\n\t\t\t\tshow_logs()                      \n\t\t\t}, \"icon-exclamation\", \"btn-default show_logs\");\t\t\n\t\t}\n\t},  \t\n})\n\n\nshow_logs = function(){\n\tif(frappe.route_options){\n\t\tconsole.log(\"in if cond\")\n\t\tfrappe.route_options[\"client_info\"] = cur_frm.doc.doctype+\"//\"+cur_frm.doc.name+\"//\"+cur_frm.doc.client+\"//\"+cur_frm.doc.phone_number\n\t}\n\telse{\n\t\tconsole.log(\"in else cond\")\n        console.log(cur_frm.doc.doctype+\"//\"+cur_frm.doc.name+\"//\"+cur_frm.doc.client+\"//\"+cur_frm.doc.phone_number,\"aaaaaaaaaa\") \t\n\t\tfrappe.route_options = {\n\t\t\t\"client_info\":cur_frm.doc.doctype+\"//\"+cur_frm.doc.name+\"//\"+cur_frm.doc.client+\"//\"+cur_frm.doc.phone_number\n\t\t}\n\t} \n\tfrappe.set_route(\"query-report\", \"Call Logs Report\");\n}", 
  "script_type": "Client"
 }
]